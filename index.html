<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Hokkaido Snow Trip - åŒ—æµ·é“è¡Œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        :root { --ice-blue: #f0f8ff; --snow-white: #ffffff; --deep-navy: #1a365d; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: var(--ice-blue); }
        /* æ—¥ç³»æ¥µç°¡æ©«å‘æ—¥æœŸé¸å–® */
        .date-slider::-webkit-scrollbar { display: none; }
        .glass-card { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.5); }
        .tab-active { color: #2b6cb0; border-bottom: 3px solid #2b6cb0; }
        .floating-tabs { position: absolute; bottom: -20px; right: 20px; z-index: 20; }
        /* æ‹–æ›³å‹•ç•« */
        .ghost-card { opacity: 0.5; background: #ebf8ff; }
    </style>
</head>
<body class="safe-area-inset-bottom">

<div id="app" class="max-w-md mx-auto min-h-screen relative shadow-2xl bg-white overflow-hidden flex flex-col">
    
    <div class="relative h-60 bg-cover bg-center shrink-0" style="background-image: url('https://images.unsplash.com/photo-1548625361-625be31b4d5b?q=80&w=1000&auto=format&fit=crop');">
        <div class="absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"></div>
        <div class="absolute top-8 left-6 text-white">
            <h1 class="text-3xl font-bold tracking-widest">åŒ—æµ·é“æ¢éšª</h1>
            <p class="text-sm opacity-90">Sapporo â€¢ Otaru â€¢ Niseko</p>
        </div>

        <div class="floating-tabs flex gap-3 bg-white/90 p-2 rounded-2xl shadow-lg border border-blue-50">
            <button v-for="t in tabs" :key="t.id" @click="currentTab = t.id" 
                    :class="['p-3 rounded-xl transition-all', currentTab === t.id ? 'bg-blue-600 text-white shadow-md' : 'text-blue-400']">
                <i :data-lucide="t.icon" class="w-6 h-6"></i>
            </button>
        </div>
    </div>

    <main class="flex-1 overflow-y-auto px-4 pt-10 pb-24">
        
        <div v-if="currentTab === 'itinerary'">
            <div class="date-slider flex gap-4 overflow-x-auto mb-6 pb-2">
                <div v-for="d in days" :key="d.date" @click="selectedDate = d.date"
                     class="flex flex-col items-center min-w-[60px] cursor-pointer transition-all"
                     :class="selectedDate === d.date ? 'scale-110 text-blue-600 font-bold' : 'text-gray-400'">
                    <span class="text-xs uppercase">{{ d.week }}</span>
                    <span class="text-2xl">{{ d.day }}</span>
                </div>
            </div>

            <div class="glass-card rounded-2xl p-4 mb-6 flex items-center justify-between border-blue-100">
                <div class="flex items-center gap-3">
                    <i data-lucide="cloud-snow" class="w-8 h-8 text-blue-400"></i>
                    <div>
                        <p class="text-sm text-gray-500 italic">ç•¶æ—¥å¤©æ°£é å ±</p>
                        <p class="text-lg font-semibold">-2Â°C / é«”æ„Ÿ -6Â°C</p>
                    </div>
                </div>
                <span class="px-3 py-1 bg-blue-50 text-blue-500 rounded-full text-xs">ä¸‹é›ªæ©Ÿç‡ 80%</span>
            </div>

            <div id="itinerary-list" class="space-y-4">
                <div v-for="(item, idx) in currentItinerary" :key="item.id" class="relative">
                    <div v-if="idx > 0" class="flex items-center gap-2 ml-10 my-2 text-xs text-blue-400 font-medium">
                        <i :data-lucide="item.transportIcon || 'car'" class="w-4 h-4"></i>
                        <span>ç´„ {{ item.travelTime }} åˆ†é˜</span>
                    </div>

                    <div v-if="item.category === 'èˆªç­'" class="bg-blue-600 text-white p-4 rounded-2xl shadow-lg flex justify-between items-center">
                        <div class="text-center">
                            <p class="text-2xl font-bold">{{ item.from }}</p>
                            <p class="text-xs opacity-80">{{ item.timeStart }}</p>
                        </div>
                        <i data-lucide="plane" class="w-6 h-6 rotate-90"></i>
                        <div class="text-center">
                            <p class="text-2xl font-bold">{{ item.to }}</p>
                            <p class="text-xs opacity-80">{{ item.timeEnd }}</p>
                        </div>
                    </div>

                    <div v-else class="glass-card p-4 rounded-2xl shadow-sm border border-gray-50 flex gap-4 items-center">
                        <div class="cursor-grab p-1 text-gray-300"><i data-lucide="grip-vertical" class="w-4 h-4"></i></div>
                        <div class="flex-1" @click="editItem(item)">
                            <div class="flex justify-between">
                                <span class="text-[10px] px-2 py-0.5 rounded bg-blue-50 text-blue-600 mb-1 inline-block">{{ item.category }}</span>
                                <span class="text-xs text-gray-400">{{ item.time }}</span>
                            </div>
                            <h3 class="font-bold text-gray-800">{{ item.name }}</h3>
                            <p class="text-xs text-gray-500 mt-1 line-clamp-1"><i data-lucide="info" class="w-3 h-3 inline mr-1"></i>{{ item.note }}</p>
                        </div>
                        <button @click="navigate(item.name)" class="bg-blue-500 text-white p-3 rounded-full shadow-lg shadow-blue-200">
                            <i data-lucide="navigation" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'info'" class="space-y-6">
            <section class="glass-card p-5 rounded-3xl">
                <h2 class="font-bold text-lg mb-4 flex items-center gap-2 text-blue-700">
                    <i data-lucide="refresh-cw" class="w-5 h-5"></i> åŒ¯ç‡æ›ç®— (ç•¶æ—¥)
                </h2>
                <div class="flex gap-3 items-center">
                    <input type="number" v-model="jpy" class="w-full p-3 rounded-xl bg-gray-50 border-none focus:ring-2 focus:ring-blue-300" placeholder="æ—¥å¹£ JPY">
                    <i data-lucide="arrow-right-left" class="text-gray-400"></i>
                    <div class="w-full p-3 rounded-xl bg-blue-50 font-bold text-blue-600">
                        {{ (jpy * 0.21).toFixed(0) }} TWD
                    </div>
                </div>
            </section>
            
            <section class="glass-card p-5 rounded-3xl">
                <h2 class="font-bold text-lg mb-4 text-blue-700">ä½å®¿è³‡è¨Š</h2>
                <div class="bg-gray-50 p-3 rounded-xl text-sm space-y-2">
                    <p>ğŸ¨ <b>æœ­å¹Œä¸‰äº•èŠ±åœ’é…’åº—</b></p>
                    <p>ğŸ“ 011-209-3131</p>
                    <p class="text-gray-500">æœ­å¹Œå¸‚ä¸­å¤®å€åŒ—5æ¢è¥¿6ä¸ç›®18-3</p>
                    <button class="text-blue-500 underline text-xs">é–‹å•Ÿå°èˆª</button>
                </div>
            </section>
        </div>

        <div v-if="currentTab === 'shop'" class="grid grid-cols-2 gap-4">
            <div v-for="p in shoppingList" class="bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-100">
                <img :src="p.img" class="w-full h-32 object-cover">
                <div class="p-3">
                    <p class="font-bold text-sm">{{ p.name }}</p>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'expense'">
            <div class="bg-blue-600 text-white p-6 rounded-3xl mb-6 shadow-xl">
                <p class="opacity-80 text-sm">ç¸½èŠ±è²»æ¦‚è¦½ (JPY)</p>
                <h2 class="text-4xl font-bold">Â¥ {{ totalExpense }}</h2>
            </div>
            <div class="space-y-3">
                <div v-for="e in expenses" class="flex justify-between p-4 bg-white rounded-2xl border-l-4 border-blue-400 shadow-sm">
                    <div>
                        <p class="font-bold">{{ e.name }}</p>
                        <p class="text-xs text-gray-400">{{ e.date }} â€¢ {{ e.category }}</p>
                    </div>
                    <p class="font-bold text-blue-600">Â¥ {{ e.amount }}</p>
                </div>
            </div>
        </div>

    </main>

    <button @click="showModal = true" class="fixed bottom-24 right-6 bg-blue-600 text-white w-14 h-14 rounded-full shadow-2xl flex items-center justify-center transition-transform active:scale-90 z-50">
        <i data-lucide="plus" class="w-8 h-8"></i>
    </button>

    <div v-if="showModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] flex items-end">
        <div class="w-full bg-white rounded-t-[3rem] p-8 animate-slide-up max-w-md mx-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold text-blue-800">ç·¨è¼¯è¡Œç¨‹</h2>
                <button @click="showModal = false" class="text-gray-400"><i data-lucide="x" class="w-6 h-6"></i></button>
            </div>
            <div class="space-y-4">
                <select v-model="editingItem.category" class="w-full p-4 bg-gray-50 rounded-2xl outline-none">
                    <option>æ™¯é»</option><option>ç¾é£Ÿ</option><option>ä½å®¿</option><option>è³¼ç‰©</option><option>èˆªç­</option>
                </select>
                <input v-model="editingItem.name" placeholder="åç¨±" class="w-full p-4 bg-gray-50 rounded-2xl outline-none">
                <textarea v-model="editingItem.note" placeholder="ç‰¹è‰²èˆ‡å‚™è¨»" class="w-full p-4 bg-gray-50 rounded-2xl outline-none"></textarea>
                
                <div class="flex gap-2">
                    <button @click="deleteItem" class="flex-1 py-4 bg-red-50 text-red-500 rounded-2xl font-bold">åˆªé™¤</button>
                    <button @click="saveItem" class="flex-[2] py-4 bg-blue-600 text-white rounded-2xl font-bold shadow-lg">å„²å­˜è¡Œç¨‹</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const { createApp, ref, onMounted, computed } = Vue;

    createApp({
        setup() {
            const currentTab = ref('itinerary');
            const selectedDate = ref('2026-01-20');
            const showModal = ref(false);
            const jpy = ref(1000);
            
            const tabs = [
                { id: 'itinerary', icon: 'map-pin' },
                { id: 'info', icon: 'info' },
                { id: 'shop', icon: 'shopping-basket' },
                { id: 'expense', icon: 'banknote' }
            ];

            const days = [
                { week: 'Mon', day: '19', date: '2026-01-19' },
                { week: 'Tue', day: '20', date: '2026-01-20' },
                { week: 'Wed', day: '21', date: '2026-01-21' },
                { week: 'Thu', day: '22', date: '2026-01-22' }
            ];

            const itinerary = ref([
                { id: 1, date: '2026-01-19', category: 'èˆªç­', from: 'TPE', to: 'CTS', timeStart: '09:30', timeEnd: '14:20' },
                { id: 2, date: '2026-01-20', category: 'æ™¯é»', name: 'å¤§é€šå…¬åœ’', time: '10:00', note: 'ç™½è‰²ç‡ˆæ¨¹ç¯€è¶…ç¾', travelTime: 15, transportIcon: 'car' },
                { id: 3, date: '2026-01-20', category: 'ç¾é£Ÿ', name: 'æ¹¯å’–å“© GARAKU', time: '12:30', note: 'æ’éšŠç´„40åˆ†é˜', travelTime: 8, transportIcon: 'bus' }
            ]);

            const shoppingList = ref([
                { name: 'ç™½è‰²æˆ€äºº', img: 'https://cdn.shopify.com/s/files/1/0273/9313/0580/products/shiroikoibito_800x.jpg?v=1600234567' }
            ]);

            const expenses = ref([
                { name: 'åˆé¤', category: 'é£²é£Ÿ', amount: 1500, date: '2026-01-20' }
            ]);

            const editingItem = ref({ category: 'æ™¯é»', name: '', note: '' });

            const currentItinerary = computed(() => {
                return itinerary.value.filter(i => i.date === selectedDate.value);
            });

            const totalExpense = computed(() => expenses.value.reduce((sum, e) => sum + e.amount, 0));

            const navigate = (place) => {
                window.open(`https://www.google.com/maps/dir/?api=1&destination=$${encodeURIComponent(place)}`, '_blank');
            };

            const deleteItem = () => {
                if(confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹è¡Œç¨‹å—ï¼Ÿ')) {
                    itinerary.value = itinerary.value.filter(i => i.id !== editingItem.value.id);
                    showModal.value = false;
                }
            };

            const saveItem = () => {
                // å„²å­˜é‚è¼¯...
                showModal.value = false;
            };

            onMounted(() => {
                lucide.createIcons();
                // åˆå§‹åŒ–æ‹–æ›³åŠŸèƒ½
                const el = document.getElementById('itinerary-list');
                if (el) {
                    Sortable.create(el, {
                        animation: 150,
                        ghostClass: 'ghost-card',
                        handle: '.cursor-grab'
                    });
                }
            });

            return { 
                currentTab, tabs, days, selectedDate, itinerary, currentItinerary, 
                showModal, editingItem, deleteItem, saveItem, navigate,
                jpy, shoppingList, expenses, totalExpense
            };
        }
    }).mount('#app');
</script>

</body>
</html>